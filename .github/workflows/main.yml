name: Complete E2E Testing Pipeline (Login & Product)

on:
  push:
    branches: [ "main" ]
  pull_request:
    branches: [ "main" ]

jobs:
  e2e-tests:
    runs-on: ubuntu-latest

    # ğŸ”´ GIá»® NGUYÃŠN CÃI TÃŠN THÆ¯ Má»¤C Báº N ÄÃƒ Sá»¬A LÃšC NÃƒY
    defaults:
      run:
        working-directory: ./frontend

    steps:
      # 1. Táº£i code vá»
      - name: Checkout Code
        uses: actions/checkout@v4

      # 2. CÃ i Ä‘áº·t mÃ´i trÆ°á»ng Node.js
      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '20'

      # 3. CÃ i Ä‘áº·t thÆ° viá»‡n (npm install)
      - name: Install Dependencies
        run: npm install

      # 4. Cháº¡y TOÃ€N Bá»˜ Test (Cáº£ Login láº«n Product)
      # LÆ°u Ã½: MÃ¬nh Ä‘Ã£ bá» Ä‘oáº¡n --spec "..." Ä‘á»ƒ nÃ³ tá»± cháº¡y táº¥t cáº£ cÃ¡c file trong folder e2e
      - name: Run All Cypress Tests
        run: npx cypress run --browser chrome

      # 5. Xuáº¥t bÃ¡o cÃ¡o (Video/áº¢nh chá»¥p lá»—i)
      - name: Upload Test Artifacts
        if: always() # LuÃ´n cháº¡y dÃ¹ test fail
        uses: actions/upload-artifact@v4
        with:
          name: complete-test-reports
          path: |
            TÃŠN_THÆ¯_Má»¤C_Cá»¦A_Báº N/cypress/videos
            TÃŠN_THÆ¯_Má»¤C_Cá»¦A_Báº N/cypress/screenshots